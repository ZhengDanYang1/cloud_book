# 第4节：API网关

作为服务网关的一种典型应用，API网关在微服务理念盛行前就已经存在了。随着近几年移动应用与企业间互联需求的增长，使得之前单一的web应用扩展到多种使用场景，不仅增加了后台服务响应率，还增加了其复杂性。在企业级的应用场景中，API网关是存在于系统边界处面向API集成、隔离内部系统与外部访问的一种强管控服务。其典型特征为可承载大量不同租户、不同业务的高流量，对于高并发、高性能、高可用、强隔离等有非常严格的要求，因此这一类API网关尤其在一些金融类机构应用得比较广泛，如银行、证券机构。

不同于企业级API网关，云原生中间件领域的API网关一般是指在微服务架构中的技术组件。在互联网高速发展的今天，企业为了快速响应市场变化的需求且适应更加灵活的业务需求，开始采用松耦合、高内聚原则的微服务架构。由于微服务众多，其调用和访问错综复杂，加上跨系统交互，会带来资源浪费甚至系统崩溃。微服务API网关在架构中扮演了关键的角色，用于隔离、保护和控制对于微服务的交互，其主要功能特点是管理授权、访问控制、流量控制、协议转换等，使得大量非业务功能沉淀至网关层，给予开发人员集中精力开发业务的便利。常见的API网关根据使用特性可以分为流量网关和业务网关，流量网关聚焦于全局流控、日志统计、负载均衡、黑白名单和安全防护等；业务网关则更关注服务级别的引流、服务注册、服务发现、聚合过滤、熔断降级以及权限控制等。

企业级API网关与微服务API网关的不同主要体现在以下几点：1、部署位置不同；2、功能侧重点不同；3、性能要求不同；4、使用场景不同；5、架构不同。在未来的应用场景中，微服务API网关与企业级API网关有融合统一的趋势，一体化的解决方案可带来非常多的优势，将充分发挥API网关在云原生领域中的应用红利。[[1]](#_msocom_1) 

网关一词较早出现在网络设备里面，比如两个相互独立的局域网段之间通过路由器或者桥接设备进行通信， 这中间的路由或者桥接设备我们称之为网关。

相应的 API 网关将各系统对外暴露的服务聚合起来，所有要调用这些服务的系统都需要通过 API 网关进行访问，基于这种方式网关可以对 API 进行统一管控，例如：认证、鉴权、流量控制、协议转换、监控等等。

API 网关的流行得益于近几年微服务架构的兴起，原本一个庞大的业务系统被拆分成许多粒度更小的系统进行独立部署和维护，这种模式势必会带来更多的跨系统交互，企业 API 的规模也会成倍增加，API 网关（或者微服务网关）就逐渐成为了微服务架构的标配组件。其主要功能如下：

1.提供防攻击、防重放、请求加密、身份认证、权限管理、流量控制等多重手段保证 API 安全，降低 API 开放风险。

2.提供 API 定义、测试、发布、下线等全生命周期管理，并生成 SDK、API 说明文档，提升 API 管理、迭代的效率。

3.提供便捷的监控、报警、分析、API 市场等运维、运营工具，降低 API 运营、维护成本。

使用API网关的最大优点是，它封装了应用程序的内部结构。客户端只需要同网关交互，而不必调用特定的服务。API网关为每一类客户端提供了特定的API。这减少了客户端与应用程序间的交互次数，还简化了客户端代码。

API网关也有一些不足，它增加了一个我们必须开发、部署和维护的高可用组件。为了暴露每个微服务的端点，开发人员必须更新API网关。API网关的更新过程要尽可能地简单，这很重要。否则，为了更新网关，开发人员将不得不排队等待。不过，虽然有这些不足，但对于大多数现实世界的应用程序而言，使用API网关是合理的。

------



 [[1]](#_msoanchor_1)逻辑：API网关分类：从企业级API网关和微服务API网关分别论述、对比其不同点来分析，对微服务网关侧重点不同进一步分析。如需增加字数和具体细节，可添加上一版中的功能点和优缺点。