# 第1节：分布式消息队列

分布式消息系统是指的利用高效可靠的消息传递机制进行平台无关的数据交流，并基于数据通信来进行分布式系统的集成的服务。消息队列是在消息的传输过程中保存消息的容器。消息队列管理器在将消息从它的源中继到它的目标时充当中间人。队列的主要目的是提供路由并保证消息的传递；如果发送消息时接收者不可用，消息队列会保留消息，直到可以成功地传递它。通过提供消息传递和消息排队模型，它可在分布环境下扩展进程间的通信，并支持多通讯协议、语言、应用程序、硬件和软件平台，实现应用系统之间的可靠异步消息通信，能够保障数据在复杂的网络中高效、稳定、安全、可靠的传输，并确保传输的数据完整准确。

目前主流的消息队列有：RabitMQ、ActiveMQ、RocketMQ、Kafka、ZeroMQ等，消息队列优点如下：

​    i.      通过异步处理提高系统性能，在不使用消息队列服务器的时候，用户的请求数据直接写入数据库，在高并发的情况下数据库压力剧增，使得响应速度变慢。但是在使用消息队列之后，用户的请求数据发送给消息队列之后立即 返回，再由消息队列的消费者进程从消息队列中获取数据，异步写入数据库。由于消息队列服务器处理速度快于数据库（消息队列也比数据库有更好的伸缩性），因此响应速度得到大幅改善。

   ii.      降低系统耦合性，消息队列使利用发布-订阅模式工作，消息发送者（生产者）发布消息，一个或多个消息接受者（消费者）订阅消息。 消息发送者（生产者）和消息接受者（消费者）之间没有直接耦合，消息发送者将消息发送至分布式消息队列即结束对消息的处理，消息接受者从分布式消息队列获取该消息后进行后续处理，并不需要知道该消息从何而来。对新增业务，只要对该类消息感兴趣，即可订阅该消息，对原有系统和业务没有任何影响，从而实现网站业务的可扩展性设计。

然而消息队列的应用也会带来一些问题：

a)   系统可用性降低： 系统可用性在降低，MQ的运行影响整个服务。

b)   系统复杂性提高： 加入MQ之后，需要保证消息没有被重复消费、处理消息丢失的情况、保证消息传递的顺序性等。

c)   一致性问题： 消息队列可以实现异步，但其一致性需要考虑。

为了使用户获得更好的服务，云服务供应商需考虑上述等问题。